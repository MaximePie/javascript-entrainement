<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="../../style.css"/>
  <title>Menu</title>
  <!--
    Cet exercice permet de travailler les compétences suivantes :
    Manipulation des tableaux
    Manipulation des fonctions
    Manipulation des objets
  -->
</head>
<body>
<div>
  <div class="Exercice">
    <div class="Consignes">
      <p>Dans cet exercice nous allons afficher la liste des sports Olympiques de 2024 !</p>
      <ul>
        <li>Consulter le fichier <code>sportsData</code>, et exporter les sports</li>
        <li>Dans <code>3-Sports.html</code>, importer tous les sports depuis <code>sportsData</code></li>
        <li>Fusionner tous les sports importés dans un seul tableau <code>sportsList</code></li>
        <li>Pour chaque sport présent dans la liste, afficher le sport avec ses informations dans une balise <code>p</code></li>
      </ul>
    </div>
    <div class="Astuce">
      <h4>Astuce</h4>
      <p>Trouvez des informations sur les forums, testez, évaluez, et choisissez le code qui vous correspond le mieux.</p>
    </div>
    <div class="Note">
      <h4>Ressources</h4>
      <ul>
        <li>
          <a href="https://www.paris2024.org/fr/sports-les-sports-olympiques/">
            Liste des sports 2024
          </a>
        </li>
        <li>
          <a href="https://stackoverflow.com/questions/38340500/export-multiple-classes-in-es6-modules">
            Exporter plusieurs modules dans le même fichier
          </a>
        </li>
        <li>
          <a href="https://gist.github.com/yesvods/51af798dd1e7058625f4">
            Fusionner des tableaux
          </a>
        </li>
      </ul>
    </div>
  </div>
  <div class="Exercice">
    <div class="Consignes">
      <p>Mettre en place un mécanisme qui permette à l'utilisateur de modifier : </p>
      <ul>
        <li>Le nom d'un sport</li>
        <li>Le nombre de joueurs d'un sport</li>
        <li>S'il est en équipe ou non avec une <code>checkbox</code></li>
        <li>Sa description</li>
        <li>Les lieux praticables (intérieur, extérieur)</li>
      </ul>
      <p>Le sport est instantanément modifié quand l'utilisateur change quoi que ce soit</p>
      <p>Quand on recharge la page, les sports reviennent à leur état initial</p>
    </div>
    <div class="Note">
      <h4>Astuces</h4>
      <p>Utilisez les classes pour mieux organiser votre code</p>
    </div>
    <div id="list">
      <h2>Liste des sports</h2>
    </div>
  </div>
</div>
<script type="module">
  import {coopGames} from './sportsData.js';
  import {soloGames} from './sportsData.js';

  class Sportlist {

    displaySports (param) {
      let parent = document.getElementById("list")
      for(let i = 0;i<param.length;i++) {
        let newSport = document.createElement("div")
        newSport.setAttribute('id', `sport${i}`)
        parent.appendChild(newSport)
        let content = `<h3><span>${param[i].name}</span> :</h3>
<p><span>${param[i].description}</span></p>
<p>Nombre de joueurs : <span>${param[i].numberOfPlayers}</span></p>
<p>Surface de jeu : <span>${param[i].playablePlaces}</span></p>`
        if (param[i].isCoop === true) {
          content += `<p>Type de jeu : <span>équipe</span></p>`
        } else {
          content += `<p>Type de jeu : <span>solo</span></p>`
        }
        newSport.innerHTML = content
        this.handleClick = () => {
          console.log("Je me déclenche pour les infos");
          this.changeSportlistInfos(`sport${i}`)
        }
        newSport.addEventListener('click', this.handleClick)
      }
    }
    changeSportlistInfos (selectedDiv) {

      console.log(selectedDiv)
      let title = document.querySelector(`#${selectedDiv} h3 span`)
      console.log(title)
      let paragraph = document.querySelectorAll(`#${selectedDiv} p span`)
      console.log(paragraph)
      let form = `<form>
<label for="title">Nouveau nom</label><input type="text" id="title" name ="title" value="${title.innerText}">
<label For="descr">Nouvelle description</label><input type="text" id="descr" name ="descr" value="${paragraph[0].innerText}">
<label For="players">Nombre de joueurs</label><input type="text" id="players" name ="players" value="${paragraph[1].innerText}">
<label For="location">Lieu de pratique</label><input type="text" id="location" name ="location" value="${paragraph[2].innerText}">
<label For="coop">Type de sport</label><input type="text" id="coop" name ="coop" value="${paragraph[3].innerText}">
<button type="button" id="save">modifier</button> <button type="button" id="reset">annuler</button>
</form>`
      document.getElementById(selectedDiv).innerHTML = form
      let save = document.getElementById('save')
      let reset = document.getElementById('reset')
      let data = {
        name:`${document.getElementById('title').value}`,
        description:`${document.getElementById('descr').value}`,
        numberOfPlayers:`${document.getElementById('players').value}`,
        playablePlaces:`${document.getElementById('location').value}`,
        isCoop:`${document.getElementById('coop').value}`
      }
      save.addEventListener('click',()=>{
        this.saveInfos(data,selectedDiv)
      })
      reset.addEventListener('click',()=>{
        resetInfos()
      })

    }
    saveInfos(data,div){
      let contentMaj = `<h3><span>${data.name}</span> :</h3>
<p><span>${data.description}</span></p>
<p>Nombre de joueurs : <span>${data.numberOfPlayers}</span></p>
<p>Surface de jeu : <span>${data.playablePlaces}</span></p>`
      if (data.isCoop === true) {
        contentMaj += `<p>Type de jeu : <span>équipe</span></p>`
      } else {
        contentMaj += `<p>Type de jeu : <span>solo</span></p>`
      }
      console.log(contentMaj)
      document.getElementById(div).innerHTML = contentMaj
      console.log(div)
      this.isEditMode = false;
    }
  }
  export {Sportlist}


  const sportsList = coopGames.concat(soloGames);

  let sport = new Sportlist(coopGames,soloGames);
  sport.displaySports(sportsList)

</script>
</body>
</html>
